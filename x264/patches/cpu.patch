--- x264_org/common/cpu.c	2024-08-30 14:07:49.184495508 +0200
+++ x264/common/cpu.c	2024-08-30 14:12:25.631746608 +0200
@@ -516,17 +516,22 @@
     // Android NDK does not expose sched_getaffinity
     return sysconf( _SC_NPROCESSORS_CONF );
 #else
-    cpu_set_t p_aff;
-    memset( &p_aff, 0, sizeof(p_aff) );
-    if( sched_getaffinity( 0, sizeof(p_aff), &p_aff ) )
-        return 1;
-#if HAVE_CPU_COUNT
-    return CPU_COUNT(&p_aff);
-#else
-    int np = 0;
-    for( size_t bit = 0; bit < 8 * sizeof(p_aff); bit++ )
-        np += (((uint8_t *)&p_aff)[bit / 8] >> (bit % 8)) & 1;
-    return np;
+    /* Phoenix-RTOS patch - no support for 'cpu_set_t' which is part of GNU extension */
+    /* Return 1 as available processor count */
+    return 1;
+#if 0
+        cpu_set_t p_aff;
+        memset( &p_aff, 0, sizeof(p_aff) );
+        if( sched_getaffinity( 0, sizeof(p_aff), &p_aff ) )
+            return 1;
+    #if HAVE_CPU_COUNT
+        return CPU_COUNT(&p_aff);
+    #else
+        int np = 0;
+        for( size_t bit = 0; bit < 8 * sizeof(p_aff); bit++ )
+            np += (((uint8_t *)&p_aff)[bit / 8] >> (bit % 8)) & 1;
+        return np;
+#endif
 #endif
 #endif
 
